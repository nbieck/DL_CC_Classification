\section{Results}

\subsection{17 Flowers}

For the small dataset, color corrected input appears to perform on par, or even slightly worse than simply using the unprocessed image.
With our model we observed a drop in accuracy of 10\% when using the Grey Edge algorithm to preprocess. It can also be seen that,
unsurprisingly, VGG16 outperforms our model in all cases. It does however train significantly longer at both training and testing time.
An overall visual comparison is presented in Figure \ref{fig:comparison_17_flowers}.

%load the data for our model with 17 flowers
\pgfplotstableread{data/ours_17_flowers_summary.csv}{\ourssmallsummary}
\begin{table}[h]
    \scriptsize
    \pgfplotstabletypeset[
        col sep=comma,
        columns={Algorithm, train_time, test_time,
                train_loss, val_loss, test_acc},
        column type = c,
        columns/Algorithm/.style={string type, column name=},
        columns/train_time/.style = {string type, column name ={Training (s)}},
        create on use/train_time/.style={%
                create col/assign/.code={%
                        \pgfmathprintpmnumber{train_time_avg}{train_time_std}
                        \pgfkeyslet{/pgfplots/table/create col/next content}\value
                    }
            },
        columns/test_time/.style = {string type, column name ={Testing (s)}},
        create on use/test_time/.style={%
                create col/assign/.code={%
                        \pgfmathprintpmnumber{test_time_avg}{test_time_std}
                        \pgfkeyslet{/pgfplots/table/create col/next content}\value
                    }
            },
        columns/train_loss/.style = {string type, column name ={Train Loss}},
        create on use/train_loss/.style={%
                create col/assign/.code={%
                        \pgfmathprintpmnumber{train_loss_avg}{train_loss_std}
                        \pgfkeyslet{/pgfplots/table/create col/next content}\value
                    }
            },
        columns/val_loss/.style = {string type, column name ={Val Loss}},
        create on use/val_loss/.style={%
                create col/assign/.code={%
                        \pgfmathprintpmnumber{val_loss_avg}{val_loss_std}
                        \pgfkeyslet{/pgfplots/table/create col/next content}\value
                    }
            },
        columns/test_acc/.style = {string type, column name ={Test Acc}},
        create on use/test_acc/.style={%
                create col/assign/.code={%
                        \pgfmathprintpmnumber{test_acc_avg}{test_acc_std}
                        \pgfkeyslet{/pgfplots/table/create col/next content}\value
                    }
            },
        every head row/.style = {before row=\hline, after row=\hline},
        every last row/.style = {after row=\hline},
        every column/.style = {column type/.add={|}{}},
        every last column/.style = {column type/.add={}{|}},
    ]{\ourssmallsummary}
    \caption{Average and Standard deviation of time to train/test, as well as final training and validation losses, and testing accuracy
    over all trials run with our model on the 17 flowers dataset.}
    \label{table:ours_17_flowers}
\end{table}

\pgfplotstableread{data/vgg16_17_flowers_summary.csv}{\vggsmallsummary}
\begin{table}
    \tiny
    \pgfplotstabletypeset[
        col sep=comma,
        columns={Algorithm, train_time, test_time,
                train_loss, val_loss, test_acc},
        column type = c,
        columns/Algorithm/.style={string type, column name=},
        columns/train_time/.style = {string type, column name ={Training (s)}},
        create on use/train_time/.style={%
                create col/assign/.code={%
                        \pgfmathprintpmnumber{train_time_avg}{train_time_std}
                        \pgfkeyslet{/pgfplots/table/create col/next content}\value
                    }
            },
        columns/test_time/.style = {string type, column name ={Testing (s)}},
        create on use/test_time/.style={%
                create col/assign/.code={%
                        \pgfmathprintpmnumber{test_time_avg}{test_time_std}
                        \pgfkeyslet{/pgfplots/table/create col/next content}\value
                    }
            },
        columns/train_loss/.style = {string type, column name ={Train Loss}},
        create on use/train_loss/.style={%
                create col/assign/.code={%
                        \pgfmathprintpmnumber{train_loss_avg}{train_loss_std}
                        \pgfkeyslet{/pgfplots/table/create col/next content}\value
                    }
            },
        columns/val_loss/.style = {string type, column name ={Val Loss}},
        create on use/val_loss/.style={%
                create col/assign/.code={%
                        \pgfmathprintpmnumber{val_loss_avg}{val_loss_std}
                        \pgfkeyslet{/pgfplots/table/create col/next content}\value
                    }
            },
        columns/test_acc/.style = {string type, column name ={Test Acc}},
        create on use/test_acc/.style={%
                create col/assign/.code={%
                        \pgfmathprintpmnumber{test_acc_avg}{test_acc_std}
                        \pgfkeyslet{/pgfplots/table/create col/next content}\value
                    }
            },
        every head row/.style = {before row=\hline, after row=\hline},
        every last row/.style = {after row=\hline},
        every column/.style = {column type/.add={|}{}},
        every last column/.style = {column type/.add={}{|}},
    ]{\vggsmallsummary}
    \caption{Average and Standard deviation of time to train/test, as well as final training and validation losses, and testing accuracy
    over all trials run with VGG16 on the 17 flowers dataset.}
    \label{table:vgg_17_flowers}
\end{table}

\begin{figure}
    \centering
    \begin{tabular}{cc}
        \begin{tikzpicture}
            \begin{axis}[
                    title = Training Time,
                    ylabel = Time/s,
                    ybar,
                    xtick=data,
                    xticklabels from table = {\ourssmallsummary}{Algorithm},
                    x tick label style = {rotate=45, anchor=east},
                    error bars/y dir=both,
                    error bars/y explicit,
                    error bars/error bar style={black},
                    ymin=0,
                    width=0.49\textwidth,
                    bar width=6pt,
                ]
                \addplot+[
                    draw=black,
                    fill=ourblue,
                ] table[
                        col sep=comma,
                        x expr=\coordindex,
                        y=train_time_avg,
                        y error=train_time_std,
                    ] {\ourssmallsummary};
                \addplot+[
                    draw=black,
                    fill=ourorange,
                ] table[
                        col sep=comma,
                        x expr=\coordindex,
                        y=train_time_avg,
                        y error=train_time_std,
                    ] {\vggsmallsummary};
            \end{axis}
        \end{tikzpicture} &
        \begin{tikzpicture}
            \begin{axis}[
                    title = Testing Time,
                    ybar,
                    xtick=data,
                    xticklabels from table = {\ourssmallsummary}{Algorithm},
                    x tick label style = {rotate=45, anchor=east},
                    error bars/y dir=both,
                    error bars/y explicit,
                    error bars/error bar style={black},
                    ylabel=Time/s,
                    no markers,
                    ymin=0,
                    width=0.49\textwidth,
                    bar width=6.pt,
                ]
                \addplot+[
                    draw=black,
                    fill=ourblue,
                ] table[
                        col sep=comma,
                        x expr=\coordindex,
                        y=test_time_avg,
                        y error=test_time_std,
                    ] {\ourssmallsummary};
                \addplot+[
                    draw=black,
                    fill=ourorange,
                ] table[
                        col sep=comma,
                        x expr=\coordindex,
                        y=test_time_avg,
                        y error=test_time_std,
                    ] {\vggsmallsummary};
            \end{axis}
        \end{tikzpicture} \\
        \begin{tikzpicture}
            \begin{axis}[
                    title = Training Loss,
                    ylabel = Loss,
                    ybar,
                    xtick=data,
                    xticklabels from table = {\ourssmallsummary}{Algorithm},
                    x tick label style = {rotate=45, anchor=east},
                    error bars/y dir=both,
                    error bars/y explicit,
                    error bars/error bar style={black},
                    ymin=0,
                    width=0.49\textwidth,
                    bar width=6pt,
                ]
                \addplot+[
                    draw=black,
                    fill=ourblue,
                ] table[
                        col sep=comma,
                        x expr=\coordindex,
                        y=train_loss_avg,
                        y error=train_loss_std,
                    ] {\ourssmallsummary};
                \addplot+[
                    draw=black,
                    fill=ourorange,
                ] table[
                        col sep=comma,
                        x expr=\coordindex,
                        y=train_loss_avg,
                        y error=train_loss_std,
                    ] {\vggsmallsummary};
            \end{axis}
        \end{tikzpicture} &
        \begin{tikzpicture}
            \begin{axis}[
                    title = Validation Loss,
                    ylabel = Loss,
                    ybar,
                    xtick=data,
                    xticklabels from table = {\ourssmallsummary}{Algorithm},
                    x tick label style = {rotate=45, anchor=east},
                    error bars/y dir=both,
                    error bars/y explicit,
                    error bars/error bar style={black},
                    ymin=0,
                    width=0.49\textwidth,
                    bar width=6pt,
                ]
                \addplot+[
                    draw=black,
                    fill=ourblue,
                ] table[
                        col sep=comma,
                        x expr=\coordindex,
                        y=val_loss_avg,
                        y error=val_loss_std,
                    ] {\ourssmallsummary};
                \addplot+[
                    draw=black,
                    fill=ourorange,
                ] table[
                        col sep=comma,
                        x expr=\coordindex,
                        y=val_loss_avg,
                        y error=val_loss_std,
                    ] {\vggsmallsummary};
            \end{axis}
        \end{tikzpicture} \\
        \begin{tikzpicture}
            \begin{axis}[
                    title = Test Accuracy,
                    ylabel = Loss,
                    ybar,
                    xtick=data,
                    xticklabels from table = {\ourssmallsummary}{Algorithm},
                    x tick label style = {rotate=45, anchor=east},
                    error bars/y dir=both,
                    error bars/y explicit,
                    error bars/error bar style={black},
                    ymin=0,
                    width=0.49\textwidth,
                    bar width=6pt,
                ]
                \addplot+[
                    draw=black,
                    fill=ourblue,
                ] table[
                        col sep=comma,
                        x expr=\coordindex,
                        y=test_acc_avg,
                        y error=test_acc_std,
                    ] {\ourssmallsummary};
                \addplot+[
                    draw=black,
                    fill=ourorange,
                ] table[
                        col sep=comma,
                        x expr=\coordindex,
                        y=test_acc_avg,
                        y error=test_acc_std
                    ] {\vggsmallsummary};
            \end{axis}
        \end{tikzpicture}
    \end{tabular}
    \caption{Comparison of the different color constancy methods on the 17 flower dataset using our model (blue) and VGG16 (orange). Data shown averaged over all runs, with the 
    standard deviation given as error bars.}
    \label{fig:comparison_17_flowers}
\end{figure}

\def\historygraphheight{5cm}

When observing the training progress shown in Figures \ref{fig:ours_17_flowers_history} and \ref{fig:vgg_17_flowers_history}, we again note that there are no particularly
egregious differences between the color constancy approaches and the simple base model. We do however note that part of the reason for the long training time of VGG16
is our choice to run all trials for the same number of epochs, with VGG16 appearing to converge around epoch 10, while our model does make use of all the time given.

%load all tables for the following graphs so we don't need to load the file for each one
\pgfplotstableread{data/train_loss_17_flowers.csv}\ourssmalltrainloss
\pgfplotstableread{data/train_accuracy_17_flowers.csv}\ourssmalltrainacc
\pgfplotstableread{data/validation_loss_17_flowers.csv}\ourssmallvalloss
\pgfplotstableread{data/validation_accuracy_17_flowers.csv}\ourssmallvalacc

\begin{figure}
    %We use a centered table with a single right-aligned column to ensure that the graphs
    %visually lign up while still being centered on the page
    \centering
    \begin{tabular}{r}
        \begin{tikzpicture}
            \begin{axis}[
                    title = Training Accuracy over Time,
                    mark repeat=1,
                    xlabel = Epoch,
                    ylabel = Accuracy,
                    legend pos=south east,
                    width=0.95\textwidth,
                    height=\historygraphheight,
                    each nth point={4},
                    legend columns=2,
                ]
                \addplot+[
                    smooth,
                ] table[
                        x = Epoch,
                        y = Base,
                    ] {\ourssmalltrainacc};
                \addlegendentry{Base}
                \addplot+[
                    smooth,
                ] table[
                        x = Epoch,
                        y = BatchNorm,
                    ] {\ourssmalltrainacc};
                \addlegendentry{Batch Norm}
                \addplot+[
                    smooth,
                ] table[
                        x = Epoch,
                        y = FC4,
                    ] {\ourssmalltrainacc};
                \addlegendentry{FC\textsuperscript{4}}
                \addplot+[
                    smooth,
                ] table[
                        x = Epoch,
                        y = WhitePatch,
                    ] {\ourssmalltrainacc};
                \addlegendentry{White Patch}
                \addplot+[
                    smooth,
                ] table[
                        x = Epoch,
                        y = GreyEdge,
                    ] {\ourssmalltrainacc};
                \addlegendentry{Grey Edge}
                \addplot+[
                    smooth,
                ] table[
                        x = Epoch,
                        y = GreyWorld,
                    ] {\ourssmalltrainacc};
                \addlegendentry{Grey World}
            \end{axis}
        \end{tikzpicture} \\
        \begin{tikzpicture}
            \begin{axis}[
                    title = Validation Accuracy over Time,
                    mark repeat=1,
                    xlabel = Epoch,
                    ylabel = Accuracy,
                    legend pos=south east,
                    width=0.95\textwidth,
                    height=\historygraphheight,
                    each nth point={4},
                    legend columns=2,
                ]
                \addplot+[
                    smooth,
                ] table[
                        x = Epoch,
                        y = Base,
                    ] {\ourssmallvalacc};
                \addlegendentry{Base}
                \addplot+[
                    smooth,
                ] table[
                        x = Epoch,
                        y = BatchNorm,
                    ] {\ourssmallvalacc};
                \addlegendentry{Batch Norm}
                \addplot+[
                    smooth,
                ] table[
                        x = Epoch,
                        y = FC4,
                    ] {\ourssmallvalacc};
                \addlegendentry{FC\textsuperscript{4}}
                \addplot+[
                    smooth,
                ] table[
                        x = Epoch,
                        y = WhitePatch,
                    ] {\ourssmallvalacc};
                \addlegendentry{White Patch}
                \addplot+[
                    smooth,
                ] table[
                        x = Epoch,
                        y = GreyEdge,
                    ] {\ourssmallvalacc};
                \addlegendentry{Grey Edge}
                \addplot+[
                    smooth,
                ] table[
                        x = Epoch,
                        y = GreyWorld,
                    ] {\ourssmallvalacc};
                \addlegendentry{Grey World}
            \end{axis}
        \end{tikzpicture}
    \end{tabular}
    \caption{For each algorithm, using our model, the development of training and validation loss and accuracy are shown
        for the trial on the 17 flower dataset ending on the lowest validation loss respectively.}
    \label{fig:ours_17_flowers_history}
\end{figure}

\pgfplotstableread{data/vgg_train_loss_17_flowers.csv}\vggsmalltrainloss
\pgfplotstableread{data/vgg_train_acc_17_flowers.csv}\vggsmalltrainacc
\pgfplotstableread{data/vgg16_val_loss_17_flowers.csv}\vggsmallvalloss
\pgfplotstableread{data/vgg16_val_accuracy_17_flowers.csv}\vggsmallvalacc

\begin{figure}
    %We use a centered table with a single right-aligned column to ensure that the graphs
    %visually lign up while still being centered on the page
    \centering
    \begin{tabular}{r}
        \begin{tikzpicture}
            \begin{axis}[
                    title = Training Accuracy over Time,
                    mark repeat=1,
                    xlabel = Epoch,
                    ylabel = Accuracy,
                    legend pos=south east,
                    width=0.95\textwidth,
                    height=\historygraphheight,
                    each nth point={4},
                    legend columns=2,
                ]
                \addplot+[
                    smooth,
                ] table[
                        x = Epoch,
                        y = Base,
                    ] {\vggsmalltrainacc};
                \addlegendentry{Base}
                \addplot+[
                    smooth,
                ] table[
                        x = Epoch,
                        y = BatchNorm,
                    ] {\vggsmalltrainacc};
                \addlegendentry{Batch Norm}
                \addplot+[
                    smooth,
                ] table[
                        x = Epoch,
                        y = FC4,
                    ] {\vggsmalltrainacc};
                \addlegendentry{FC\textsuperscript{4}}
                \addplot+[
                    smooth,
                ] table[
                        x = Epoch,
                        y = WhitePatch,
                    ] {\vggsmalltrainacc};
                \addlegendentry{White Patch}
                \addplot+[
                    smooth,
                ] table[
                        x = Epoch,
                        y = GreyEdge,
                    ] {\vggsmalltrainacc};
                \addlegendentry{Grey Edge}
                \addplot+[
                    smooth,
                ] table[
                        x = Epoch,
                        y = GreyWorld,
                    ] {\vggsmalltrainacc};
                \addlegendentry{Grey World}
            \end{axis}
        \end{tikzpicture} \\
        \begin{tikzpicture}
            \begin{axis}[
                    title = Validation Accuracy over Time,
                    mark repeat=1,
                    xlabel = Epoch,
                    ylabel = Accuracy,
                    legend pos=south east,
                    width=0.95\textwidth,
                    height=\historygraphheight,
                    each nth point={4},
                    legend columns=2,
                ]
                \addplot+[
                    smooth,
                ] table[
                        x = Epoch,
                        y = Base,
                    ] {\vggsmallvalacc};
                \addlegendentry{Base}
                \addplot+[
                    smooth,
                ] table[
                        x = Epoch,
                        y = BatchNorm,
                    ] {\vggsmallvalacc};
                \addlegendentry{Batch Norm}
                \addplot+[
                    smooth,
                ] table[
                        x = Epoch,
                        y = FC4,
                    ] {\vggsmallvalacc};
                \addlegendentry{FC\textsuperscript{4}}
                \addplot+[
                    smooth,
                ] table[
                        x = Epoch,
                        y = WhitePatch,
                    ] {\vggsmallvalacc};
                \addlegendentry{White Patch}
                \addplot+[
                    smooth,
                ] table[
                        x = Epoch,
                        y = GreyEdge,
                    ] {\vggsmallvalacc};
                \addlegendentry{Grey Edge}
                \addplot+[
                    smooth,
                ] table[
                        x = Epoch,
                        y = GreyWorld,
                    ] {\vggsmallvalacc};
                \addlegendentry{Grey World}
            \end{axis}
        \end{tikzpicture}
    \end{tabular}
    \caption{For each algorithm, using VGG16, the development of training and validation loss and accuracy are shown
        for the trial on the 17 flower dataset ending on the lowest validation loss respectively.}
    \label{fig:vgg_17_flowers_history}
\end{figure}

\subsection{102 Flowers}

%load the data for our model with 102 flowers
\pgfplotstableread{data/ours_102_flowers_summary.csv}{\ourslargesummary}
\begin{table}
    \scriptsize
    \pgfplotstabletypeset[
        col sep=comma,
        columns={Algorithm, train_time, test_time,
                train_loss, val_loss, test_acc},
        column type = c,
        columns/Algorithm/.style={string type, column name=},
        columns/train_time/.style = {string type, column name ={Training (s)}},
        create on use/train_time/.style={%
                create col/assign/.code={%
                        \pgfmathprintpmnumber{train_time_avg}{train_time_std}
                        \pgfkeyslet{/pgfplots/table/create col/next content}\value
                    }
            },
        columns/test_time/.style = {string type, column name ={Testing (s)}},
        create on use/test_time/.style={%
                create col/assign/.code={%
                        \pgfmathprintpmnumber{test_time_avg}{test_time_std}
                        \pgfkeyslet{/pgfplots/table/create col/next content}\value
                    }
            },
        columns/train_loss/.style = {string type, column name ={Train Loss}},
        create on use/train_loss/.style={%
                create col/assign/.code={%
                        \pgfmathprintpmnumber{train_loss_avg}{train_loss_std}
                        \pgfkeyslet{/pgfplots/table/create col/next content}\value
                    }
            },
        columns/val_loss/.style = {string type, column name ={Val Loss}},
        create on use/val_loss/.style={%
                create col/assign/.code={%
                        \pgfmathprintpmnumber{val_loss_avg}{val_loss_std}
                        \pgfkeyslet{/pgfplots/table/create col/next content}\value
                    }
            },
        columns/test_acc/.style = {string type, column name ={Test Acc}},
        create on use/test_acc/.style={%
                create col/assign/.code={%
                        \pgfmathprintpmnumber{test_acc_avg}{test_acc_std}
                        \pgfkeyslet{/pgfplots/table/create col/next content}\value
                    }
            },
        every head row/.style = {before row=\hline, after row=\hline},
        every last row/.style = {after row=\hline},
        every column/.style = {column type/.add={|}{}},
        every last column/.style = {column type/.add={}{|}},
    ]{\ourslargesummary}
    \caption{Summary data obtained from running our model on the 102 flowers dataset.}
    \label{table:ours_102_flowers}
\end{table}

\begin{figure}
    \centering
    \begin{tabular}{cc}
        \begin{tikzpicture}
            \begin{axis}[
                    title = Training Time,
                    ylabel = Time/s,
                    ybar,
                    xtick=data,
                    xticklabels from table = {\ourslargesummary}{Algorithm},
                    x tick label style = {rotate=45, anchor=east},
                    error bars/y dir=both,
                    error bars/y explicit,
                    error bars/error bar style={black},
                    ymin=0,
                    width=0.49\textwidth,
                    bar width=6pt,
                ]
                \addplot+[
                    draw=black,
                    fill=ourblue,
                ] table[
                        col sep=comma,
                        x expr=\coordindex,
                        y=train_time_avg,
                        y error=train_time_std,
                    ] {\ourslargesummary};
                \addplot+[
                    draw=black,
                    fill=ourorange,
                ] table[
                        col sep=comma,
                        x expr=\coordindex,
                        y=train_time_avg,
                        y error=train_time_std,
                    ] {\ourslargesummary};
            \end{axis}
        \end{tikzpicture} &
        \begin{tikzpicture}
            \begin{axis}[
                    title = Testing Time,
                    ybar,
                    xtick=data,
                    xticklabels from table = {\ourslargesummary}{Algorithm},
                    x tick label style = {rotate=45, anchor=east},
                    error bars/y dir=both,
                    error bars/y explicit,
                    error bars/error bar style={black},
                    ylabel=Time/s,
                    no markers,
                    ymin=0,
                    width=0.49\textwidth,
                    bar width=6.pt,
                ]
                \addplot+[
                    draw=black,
                    fill=ourblue,
                ] table[
                        col sep=comma,
                        x expr=\coordindex,
                        y=test_time_avg,
                        y error=test_time_std,
                    ] {\ourslargesummary};
                \addplot+[
                    draw=black,
                    fill=ourorange,
                ] table[
                        col sep=comma,
                        x expr=\coordindex,
                        y=test_time_avg,
                        y error=test_time_std,
                    ] {\ourslargesummary};
            \end{axis}
        \end{tikzpicture} \\
        \begin{tikzpicture}
            \begin{axis}[
                    title = Training Loss,
                    ylabel = Loss,
                    ybar,
                    xtick=data,
                    xticklabels from table = {\ourslargesummary}{Algorithm},
                    x tick label style = {rotate=45, anchor=east},
                    error bars/y dir=both,
                    error bars/y explicit,
                    error bars/error bar style={black},
                    ymin=0,
                    width=0.49\textwidth,
                    bar width=6pt,
                ]
                \addplot+[
                    draw=black,
                    fill=ourblue,
                ] table[
                        col sep=comma,
                        x expr=\coordindex,
                        y=train_loss_avg,
                        y error=train_loss_std,
                    ] {\ourslargesummary};
                \addplot+[
                    draw=black,
                    fill=ourorange,
                ] table[
                        col sep=comma,
                        x expr=\coordindex,
                        y=train_loss_avg,
                        y error=train_loss_std,
                    ] {\ourslargesummary};
            \end{axis}
        \end{tikzpicture} &
        \begin{tikzpicture}
            \begin{axis}[
                    title = Validation Loss,
                    ylabel = Loss,
                    ybar,
                    xtick=data,
                    xticklabels from table = {\ourslargesummary}{Algorithm},
                    x tick label style = {rotate=45, anchor=east},
                    error bars/y dir=both,
                    error bars/y explicit,
                    error bars/error bar style={black},
                    ymin=0,
                    width=0.49\textwidth,
                    bar width=6pt,
                ]
                \addplot+[
                    draw=black,
                    fill=ourblue,
                ] table[
                        col sep=comma,
                        x expr=\coordindex,
                        y=val_loss_avg,
                        y error=val_loss_std,
                    ] {\ourslargesummary};
                \addplot+[
                    draw=black,
                    fill=ourorange,
                ] table[
                        col sep=comma,
                        x expr=\coordindex,
                        y=val_loss_avg,
                        y error=val_loss_std,
                    ] {\ourslargesummary};
            \end{axis}
        \end{tikzpicture} \\
        \begin{tikzpicture}
            \begin{axis}[
                    title = Test Accuracy,
                    ylabel = Loss,
                    ybar,
                    xtick=data,
                    xticklabels from table = {\ourslargesummary}{Algorithm},
                    x tick label style = {rotate=45, anchor=east},
                    error bars/y dir=both,
                    error bars/y explicit,
                    error bars/error bar style={black},
                    ymin=0,
                    width=0.49\textwidth,
                    bar width=6pt,
                ]
                \addplot+[
                    draw=black,
                    fill=ourblue,
                ] table[
                        col sep=comma,
                        x expr=\coordindex,
                        y=test_acc_avg,
                        y error=test_acc_std,
                    ] {\ourslargesummary};
                \addplot+[
                    draw=black,
                    fill=ourorange,
                ] table[
                        col sep=comma,
                        x expr=\coordindex,
                        y=test_acc_avg,
                        y error=test_acc_std,
                    ] {\ourslargesummary};
            \end{axis}
        \end{tikzpicture}
    \end{tabular}
    \caption{Comparison a comparison of the different color constancy methods on the 102 flower dataset using our model (blue) and VGG16 (orange).}
    \label{fig:comparison_102_flowers}
\end{figure}

\pgfplotstableread{data/train_loss_17_flowers.csv}\ourslargetrainloss
\pgfplotstableread{data/train_accuracy_17_flowers.csv}\ourslargetrainacc
\pgfplotstableread{data/validation_loss_17_flowers.csv}\ourslargevalloss
\pgfplotstableread{data/validation_accuracy_17_flowers.csv}\ourslargevalacc

\begin{figure}
    %We use a centered table with a single right-aligned column to ensure that the graphs
    %visually lign up while still being centered on the page
    \centering
    \begin{tabular}{r}
        \begin{tikzpicture}
            \begin{axis}[
                    title = Training Accuracy over Time,
                    mark repeat=1,
                    xlabel = Epoch,
                    ylabel = Accuracy,
                    legend pos=south east,
                    width=0.95\textwidth,
                    height=\historygraphheight,
                    each nth point={4},
                    legend columns=2,
                ]
                \addplot+[
                    smooth,
                ] table[
                        x = Epoch,
                        y = Base,
                    ] {\ourslargetrainacc};
                \addlegendentry{Base}
                \addplot+[
                    smooth,
                ] table[
                        x = Epoch,
                        y = BatchNorm,
                    ] {\ourslargetrainacc};
                \addlegendentry{Batch Norm}
                \addplot+[
                    smooth,
                ] table[
                        x = Epoch,
                        y = FC4,
                    ] {\ourslargetrainacc};
                \addlegendentry{FC\textsuperscript{4}}
                \addplot+[
                    smooth,
                ] table[
                        x = Epoch,
                        y = WhitePatch,
                    ] {\ourslargetrainacc};
                \addlegendentry{White Patch}
                \addplot+[
                    smooth,
                ] table[
                        x = Epoch,
                        y = GreyEdge,
                    ] {\ourslargetrainacc};
                \addlegendentry{Grey Edge}
                \addplot+[
                    smooth,
                ] table[
                        x = Epoch,
                        y = GreyWorld,
                    ] {\ourslargetrainacc};
                \addlegendentry{Grey World}
            \end{axis}
        \end{tikzpicture} \\
        \begin{tikzpicture}
            \begin{axis}[
                    title = Validation Accuracy over Time,
                    mark repeat=1,
                    xlabel = Epoch,
                    ylabel = Accuracy,
                    legend pos=south east,
                    width=0.95\textwidth,
                    height=\historygraphheight,
                    each nth point={4},
                    legend columns=2,
                ]
                \addplot+[
                    smooth,
                ] table[
                        x = Epoch,
                        y = Base,
                    ] {\ourslargevalacc};
                \addlegendentry{Base}
                \addplot+[
                    smooth,
                ] table[
                        x = Epoch,
                        y = BatchNorm,
                    ] {\ourslargevalacc};
                \addlegendentry{Batch Norm}
                \addplot+[
                    smooth,
                ] table[
                        x = Epoch,
                        y = FC4,
                    ] {\ourslargevalacc};
                \addlegendentry{FC\textsuperscript{4}}
                \addplot+[
                    smooth,
                ] table[
                        x = Epoch,
                        y = WhitePatch,
                    ] {\ourslargevalacc};
                \addlegendentry{White Patch}
                \addplot+[
                    smooth,
                ] table[
                        x = Epoch,
                        y = GreyEdge,
                    ] {\ourslargevalacc};
                \addlegendentry{Grey Edge}
                \addplot+[
                    smooth,
                ] table[
                        x = Epoch,
                        y = GreyWorld,
                    ] {\ourslargevalacc};
                \addlegendentry{Grey World}
            \end{axis}
        \end{tikzpicture}
    \end{tabular}
    \caption{For each algorithm, using our model, the development of training and validation loss and accuracy are shown
        for the trial on the 102 flower dataset ending on the lowest validation loss respectively.}
    \label{fig:ours_102_flowers_history}
\end{figure}